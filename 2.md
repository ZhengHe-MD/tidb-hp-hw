# ç¬¬ 2 å‘¨

## æµ‹è¯•æŠ¥å‘Š

### éƒ¨ç½²ç¯å¢ƒçš„æœºå™¨é…ç½®

åœ¨ AWS Lightsail ä¸Šç§Ÿç”¨è™šæ‹Ÿæœºï¼š

| èŠ‚ç‚¹åç§° | éƒ¨ç½²æœåŠ¡                    | CPU     | å†…å­˜ | ç£ç›˜è§„æ ¼å‹å· |
| -------- | --------------------------- | ------- | ---- | ------------ |
| PD1      | TiDB/PD                     | 4 vCPUs | 16G  | 320GB SSD    |
| KV1      | TiKV                        | 8 vCPUs | 32G  | 640GB SSD    |
| KV2      | TiKV                        | 8 vCPUs | 32G  | 640GB SSD    |
| KV3      | TiKV                        | 8 vCPUs | 32G  | 640GB SSD    |
| Client   | æ— æœåŠ¡ (ç”¨äºä½œä¸ºæµ‹è¯•å®¢æˆ·ç«¯) | 4 vCPUs | 16G  | 320GB SSD    |

ç”±äºä½¿ç”¨äº† 3 ä¸ªèŠ‚ç‚¹åˆ†åˆ«éƒ¨ç½² TiKVï¼Œå› æ­¤ä¸éœ€è¦è°ƒæ•´ TiKV çº¿ç¨‹æ± é…ç½®ã€‚

#### Tiup éƒ¨ç½²

éƒ¨ç½²å®Œæ¯•åï¼Œæ‰§è¡Œï¼š

```sh
$ tiup cluster display tidb-test
```

å¾—åˆ°ä¸‹å›¾å†…å®¹ï¼š

![tiup-display](./2/tiup-display.jpg)

åˆ©ç”¨ mysql client è¿æ¥ TiDB å¹¶åˆ›å»ºç¤ºä¾‹æ•°æ®åº“ï¼š

![mysql-client](./2/mysql-client.jpg)

è®¿é—® Dashboardï¼š

![dashboard](./2/tidb-dashboard.jpg)

è®¿é—® Grafanaï¼š

![tidb-grafana](./2/tidb-grafana.jpg)

### sysbench

åœ¨ Client æœºå™¨ä¸Šå®‰è£… sysbenchï¼š

```sh
$ curl -s https://packagecloud.io/install/repositories/akopytov/sysbench/script.rpm.sh | sudo bash
$ sudo yum -y install sysbench
```

å®‰è£… mysql clientï¼š

```sh
$ sudo yum install mysql
```

ç¼–è¾‘ configï¼š

```
mysql-host=172.26.14.248
mysql-port=4000
mysql-user=root
mysql-db=sbtest
report-interval=10
```

å‡†å¤‡æ•°æ®ï¼š

```sh
$ sysbench oltp_update_non_index --config-file=config --threads=32 --tables=32 --table_size=1000000 prepare
```

å‘ç° TiDB çš„æ—¶å»¶ç«‹é©¬ä¸Šå»ï¼š

![sysbench-prepare-data-tidb-duration](./2/sysbench-prepare-data-tidb-duration.jpg)

åœ¨æ’å…¥æ•°æ®çš„æ—¶å€™æŠ“ä¸€ä¸ª [profile](./2/profiling_1_1_tidb_172_26_14_248_4000487838176.svg)ï¼Œå‘ç°èŠ±è´¹æ—¶é—´è¾ƒå¤šçš„æ¨¡å—æ˜¯ parser (yyParse)ã€table (CastValue) ä»¥åŠ tables (AddRecord)ï¼Œå‰è€…é¡¾åæ€ä¹‰åº”è¯¥æ˜¯è§£æ SQL çš„æ¨¡å—ï¼Œåè€…æ˜¯åœ¨æ‰§è¡Œæ’å…¥è¯­å¥çš„æ—¶å€™åšæ•°æ®ç±»å‹è½¬æ¢å’Œæ‰§è¡Œæ¨¡å—ï¼›åœ¨æ’å…¥ç´¢å¼•çš„æ—¶å€™æŠ“ä¸€ä¸ª [profile](./2/profiling_2_2_tidb_172_26_14_248_4000727712329.svg)ï¼Œå‘ç°èŠ±è´¹æ—¶é—´è¾ƒå¤šçš„æ˜¯ ddl (backfillIndexInTxn)ï¼Œä»¥åŠ runtime ä¸­çš„ mallocgc å’Œ scanobjectï¼Œ999 çº¿åœ¨ 10s å·¦å³ã€‚æš‚æ—¶å¿½ç•¥è¿™ä¸ªé—®é¢˜ã€‚

å¦å¤–å†å‡†å¤‡ä¸€ä¸ªå°ä¸€äº›çš„æ•°æ®é›†ï¼Œä½œä¸ºå¯¹æ¯”ï¼š

```sh
$ sysbench oltp_update_non_index --config-file=config-small --threads=32 --tables=8 --table_size=100000 prepare
```

#### oltp_point_select

å…ˆé¢„å…ˆç”¨ 16, 32, 64, 128, 256, 512 çº¿ç¨‹æ•°è·‘ä¸€æ¬¡ï¼Œå¤§è‡´å¯ä»¥çœ‹å‡ºï¼Œéšç€çº¿ç¨‹æ•°çš„å¢åŠ ï¼Œ95 åˆ†ä½åœ¨å¢åŠ ï¼Œtps ä¹Ÿåœ¨å¢åŠ ï¼Œä½† tps çš„å¢åŠ ç‡ (äºŒé˜¶å¯¼) åœ¨å‡å°‘ï¼Œç¬¦åˆé¢„æœŸï¼Œç»è¿‡æƒè¡¡ï¼Œå– `--threads = 128`ï¼š

```sh
$ sysbench --config-file=config oltp_point_select --threads=128 --tables=32 --table-size=1000000 --time=100 run
$ sysbench --config-file=config-small oltp_point_select --threads=128 --tables=8 --table-size=100000 --time=100 run
```

åœ¨å¤§æ•°æ®é›†ä¸Šçš„è¿è¡ŒæŠ¥å‘Šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![oltp_point_select](./2/sysbench-oltp-point-select.jpg)

tps/qps åœ¨ 3.1W å·¦å³ï¼Œæ—¶å»¶çš„ 95 åˆ†ä½åœ¨ 7.7msï¼Œæ—¶å»¶æœ€å¤§å€¼ä¸º 58msã€‚

åœ¨å°æ•°æ®é›†ä¸Šçš„è¿è¡ŒæŠ¥å‘Šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![oltp_point_select](./2/sysbench-oltp-point-select-small.jpg)

åŸºæœ¬ä¸ŠæŒ‡æ ‡æ¯”å¤§æ•°æ®é›†è¡¨ç°ç¨å¥½ä¸€ç‚¹ï¼Œä½†ä¸æ˜æ˜¾ï¼Œç¬¦åˆé¢„æœŸã€‚

è¿½äº†ä¸€ä¸‹[æºç ](https://github.com/akopytov/sysbench/blob/master/src/lua/oltp_common.lua)ï¼Œ`oltp_point_select` ç”¨çš„æ˜¯ä¸»é”®ï¼š

```lua
point_selects = {"SELECT c FROM sbtest%u WHERE id=?", t.INT}
```

#### oltp_update_index

å…ˆé¢„å…ˆç”¨ 16, 32, 64, 128, 256, 512 çº¿ç¨‹æ•°è·‘ä¸€æ¬¡ï¼Œè§„å¾‹å’Œ `oltp_point_select` çš„ä¸€æ ·ï¼Œçº¿ç¨‹æ•°å– 128 æˆ– 256 éƒ½è¿˜ä¸é”™ï¼Œè¿™é‡Œç»§ç»­å– `threads=128`ï¼š

```sh
$ sysbench --config-file=config oltp_update_index --threads=128 --tables=32 --table-size=1000000 --time=100 run
$ sysbench --config-file=config-small oltp_update_index --threads=128 --tables=8 --table-size=1000000 --time=100 run
```

åœ¨å¤§æ•°æ®é›†ä¸Šçš„è¿è¡ŒæŠ¥å‘Šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![sysbench-oltp-update-index](./2/sysbench-oltp-update-index.jpg)

tps/qps åœ¨ 5.5K å·¦å³ï¼Œ95 æ—¶å»¶åˆ†ä½åœ¨ 40msï¼Œæ—¶å»¶æœ€å¤§å€¼ä¸º 3.1sã€‚

åœ¨å°æ•°æ®é›†ä¸Šçš„è¿è¡ŒæŠ¥å‘Šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![sysbench-oltp-update-index-small](./2/sysbench-oltp-update-index-small.jpg)

ç´¢å¼•æ›´æ–°åœ¨å°æ•°æ®é›†ä¸Šçš„è¡¨ç°æ˜æ˜¾æ›´å¥½ï¼Œtps/qps åœ¨ 2.3W å·¦å³ï¼Œ95 æ—¶å»¶åˆ†ä½åœ¨ 10msï¼Œæ—¶å»¶æœ€å¤§å€¼ä¸º 43msã€‚åŸå› æš‚ä¸è¿½æŸ¥ï¼Œç›²çŒœæ˜¯å› ä¸ºæ•°æ®é‡å¤§å¯¼è‡´ç´¢å¼•å’Œæ•°æ®çš„å±€éƒ¨æ€§ä¸å¤Ÿç†æƒ³ã€‚

å¦å¤– `oltp_update_index` èµ°çš„æ˜¯æ™®é€šç´¢å¼• (äºŒçº§ç´¢å¼•ï¼Œä¸”éå”¯ä¸€ç´¢å¼•)ï¼š

```lua
index_updates = {"UPDATE sbtest%u SET k=k+1 WHERE id=?", t.INT}
```

#### read-only

read-only åœ¨ä¸€ä¸ªäº‹åŠ¡å†…è¿è¡Œäº”ç§åªè¯»æŸ¥è¯¢ï¼špoint_selects (10æ¬¡)ã€simple_rangesã€sum_rangesã€order_ranges å’Œ distinct_rangesï¼Œå…·ä½“å¦‚ä¸‹ï¼š

```lua
local stmt_defs = {
   point_selects = {"SELECT c FROM sbtest%u WHERE id=?", t.INT},
   simple_ranges = {"SELECT c FROM sbtest%u WHERE id BETWEEN ? AND ?", t.INT, t.INT},
   sum_ranges = {"SELECT SUM(k) FROM sbtest%u WHERE id BETWEEN ? AND ?", t.INT, t.INT},
   order_ranges = {"SELECT c FROM sbtest%u WHERE id BETWEEN ? AND ? ORDER BY c", t.INT, t.INT},
   distinct_ranges = {"SELECT DISTINCT c FROM sbtest%u WHERE id BETWEEN ? AND ? ORDER BY c",
t.INT, t.INT},
}
```

å…¶ä¸­ range_size é»˜è®¤å–å€¼ä¸º 100ã€‚

å…ˆé¢„å…ˆç”¨ 16, 32, 64, 128, 256, 512 çº¿ç¨‹æ•°è·‘ä¸€æ¬¡ï¼Œçº¿ç¨‹æ•°åœ¨ 32 å·¦å³ tps ä¸æ—¶å»¶ä¹‹é—´çš„ trade-off æ¯”è¾ƒç†æƒ³ï¼Œå› æ­¤è®¾ç½® `--threads=32`ï¼š

```sh
$ sysbench --config-file=config oltp_read_only --threads=32 --tables=32 --table-size=1000000 --time=100 run
$ sysbench --config-file=config oltp_read_only --threads=32 --tables=8 --table-size=100000 --time=100 run
```

åœ¨å¤§æ•°æ®é›†ä¸Šçš„è¿è¡ŒæŠ¥å‘Šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![sysbench-oltp-read-only](./2/sysbench-oltp-read-only.jpg)

tps 620ï¼Œqps 1Wï¼Œ95 æ—¶å»¶åˆ†ä½ 70msã€‚

åœ¨å°æ•°æ®é›†ä¸Šçš„è¿è¡ŒæŠ¥å‘Šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![sysbench-oltp-read-only-small](./2/sysbench-oltp-read-only-small.jpg)

æŒ‡æ ‡åŸºæœ¬æŒå¹³ã€‚è¿™é‡Œéƒ½æ˜¯æŒ‰ç…§ id è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼Œæ•ˆç‡æŒå¹³å¯ä»¥ç†è§£ã€‚

### go-ycsb

#### workloada

```sh
# å¤§æ•°æ®é›†
# è½½å…¥æ•°æ®
$ ./bin/go-ycsb load mysql -P workloads/workloada -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
# è¿è¡Œ workload
$ ./bin/go-ycsb run mysql -P workloads/workloada -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64

# å°æ•°æ®é›†
$ ./bin/go-ycsb load mysql -P workloads/workloada -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
$ ./bin/go-ycsb run mysql -P workloads/workloada -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64
```

ç»è¿‡è¯•é”™å‘ç° threads å– 64 åœ¨æ—¶å»¶å’Œ ops é—´èƒ½å–å¾—è¾ƒå¥½çš„å‡è¡¡ã€‚

å¤§æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloada-1000000](./2/go-ycsb-workloada-1000000.jpg)

å°æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloada-100000](./2/go-ycsb-workloada-100000.jpg)

#### workloadb

```sh
# å¤§æ•°æ®é›†
# è½½å…¥æ•°æ®
$ ./bin/go-ycsb load mysql -P workloads/workloadb -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
# è¿è¡Œ workload
$ ./bin/go-ycsb run mysql -P workloads/workloadb -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64

# å°æ•°æ®é›†
$ ./bin/go-ycsb load mysql -P workloads/workloadb -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
$ ./bin/go-ycsb run mysql -P workloads/workloadb -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64
```

ç»è¿‡è¯•é”™å‘ç° threads å– 64 åœ¨æ—¶å»¶å’Œ ops é—´èƒ½å–å¾—è¾ƒå¥½çš„å‡è¡¡ã€‚

å¤§æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloadb-1000000](./2/go-ycsb-workloadb-1000000.jpg)

å°æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloadb-100000](./2/go-ycsb-workloadb-100000.jpg)

#### workloadc

```sh
# å¤§æ•°æ®é›†
# è½½å…¥æ•°æ®
$ ./bin/go-ycsb load mysql -P workloads/workloadc -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
# è¿è¡Œ workload
$ ./bin/go-ycsb run mysql -P workloads/workloadc -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64

# å°æ•°æ®é›†
$ ./bin/go-ycsb load mysql -P workloads/workloadc -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
$ ./bin/go-ycsb run mysql -P workloads/workloadc -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64
```

ç»è¿‡è¯•é”™å‘ç° threads å– 64 åœ¨æ—¶å»¶å’Œ ops é—´èƒ½å–å¾—è¾ƒå¥½çš„å‡è¡¡ã€‚

å¤§æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloadc-1000000](./2/go-ycsb-workloadc-1000000.jpg)

å°æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloadc-100000](./2/go-ycsb-workloadc-100000.jpg)

#### workloadd

```sh
# å¤§æ•°æ®é›†
# è½½å…¥æ•°æ®
$ ./bin/go-ycsb load mysql -P workloads/workloadd -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
# è¿è¡Œ workload
$ ./bin/go-ycsb run mysql -P workloads/workloadd -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64

# å°æ•°æ®é›†
$ ./bin/go-ycsb load mysql -P workloads/workloadd -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
$ ./bin/go-ycsb run mysql -P workloads/workloadd -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64
```

å¤§æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloadd-1000000](./2/go-ycsb-workloadd-1000000.jpg)

å°æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloadd-100000](./2/go-ycsb-workloadd-100000.jpg)

#### workloade

```sh
# å¤§æ•°æ®é›†
# è½½å…¥æ•°æ®
$ ./bin/go-ycsb load mysql -P workloads/workloade -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
# è¿è¡Œ workload
$ ./bin/go-ycsb run mysql -P workloads/workloade -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64

# å°æ•°æ®é›†
$ ./bin/go-ycsb load mysql -P workloads/workloade -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
$ ./bin/go-ycsb run mysql -P workloads/workloade -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64
```

å¤§æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloade-1000000](./2/go-ycsb-workloade-1000000.jpg)

å°æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloade-100000](./2/go-ycsb-workloade-100000.jpg)

#### workloadf

```sh
# å¤§æ•°æ®é›†
# è½½å…¥æ•°æ®
$ ./bin/go-ycsb load mysql -P workloads/workloadf -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
# è¿è¡Œ workload
$ ./bin/go-ycsb run mysql -P workloads/workloadf -p recordcount=1000000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64

# å°æ•°æ®é›†
$ ./bin/go-ycsb load mysql -P workloads/workloadf -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 256
$ ./bin/go-ycsb run mysql -P workloads/workloadf -p recordcount=100000 -p mysql.host=172.26.14.248 -p mysql.port=4000 --threads 64
```

å¤§æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloadf-1000000](./2/go-ycsb-workloadf-1000000.jpg)

å°æ•°æ®é›†ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š

![go-ycsb-workloadf-100000](./2/go-ycsb-workloadf-100000.jpg)

### go-tpc

#### TPC-C

ç”±äº warehouses = 1000 éœ€è¦ç­‰å¾…å¤ªé•¿æ—¶é—´ï¼Œå†³å®šå– 100ï¼š

```sh
# å‡†å¤‡æ•°æ®
$ ./bin/go-tpc tpcc prepare -H 172.26.14.248 -P 4000 -D tpcc --warehouses 100
# è¿è¡Œæµ‹è¯•
$ ./bin/go-tpc tpcc run -H 172.26.14.248 -P 4000 -D tpcc --warehouses 100
```

è¿è¡Œç»“æœå¦‚ä¸‹ï¼š

![tpcc-100](./2/tpcc-100.jpg)

#### TPC-H

å…ˆåå°è¯•äº† sf å–å€¼ 40ï¼Œ 10ï¼Œ 4ï¼Œå‘ç°æ‰§è¡Œ Q5 çš„å†…å­˜éƒ½ä¸å¤Ÿï¼Œå› æ­¤åªèƒ½å– 1ï¼š

```sh
# å‡†å¤‡æ•°æ®
$ ./bin/go-tpc tpch run -H 172.26.14.248 -P 4000 -D tpch --sf 1 --db tpch
# è¿è¡Œæµ‹è¯•
$ ./bin/go-tpc tpch prepare -H 172.26.14.248 -P 4000 -D tpch --sf 1 --db tpch
```

è¿è¡Œç»“æœå¦‚ä¸‹ï¼š

![tpch-1](./2/tpch-1.jpg)

### å…³é”®æŒ‡æ ‡çš„ç›‘æ§æˆªå›¾

å› ä¸ºæ˜¨æ™šå®éªŒåå°±æŠŠå®ä¾‹é”€æ¯äº†ï¼Œæ‰å‘ç°è¿˜æœ‰è¿™ä¸€æ­¥ï¼Œå°±ä¸å†è´¹å‘¨ç« é‡æ–°éƒ¨ç½²äº†ã€‚ğŸ˜‘ï¼Œæ”¾å‡ ä¸ªä¹‹å‰æˆªçš„ä¸å±äºé¢˜ç›®è¦æ±‚çš„å›¾ï¼Œè¯æ˜æˆ‘çœ‹è¿‡ï¼š

##### TiKV CPU

![sysbench-prepare-data-tikv-cpu](./2/sysbench-prepare-data-tikv-cpu.jpg)

##### TiDB Duration

![sysbench-prepare-data-tidb-duration](./2/sysbench-prepare-data-tidb-duration.jpg)

### æ€§èƒ½ç“¶é¢ˆåˆ†æ

åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘å¯¹ä»¥ä¸‹åœºæ™¯åšäº† profile æŠ“å–ï¼š

* [sysbench_prepare_data](./2sysbench_prepare_data)
* [sysbench_prepare_index](./2/sysbench_prepare_index.svg)
* [sysbench-oltp-point-select-small](./2/sysbench-oltp-point-select-small.svg)
* [sysbench-oltp-point-select](./2/sysbench-oltp-point-select.svg)
* [sysbench-oltp-read-only](./2/sysbench-oltp-read-only.svg)
* [sysbench-oltp-update-index-small](./2/sysbench-oltp-update-index-small.svg)
* [sysbench-oltp-update-index](./2/sysbench-oltp-update-index.svg)
* [tpcc-100](./2/tpcc-100.svg)
* [tpch-sf-10-q5](./2/tpch-sf-10-q5.svg)

å…¶ä¸­å‘ç°è€—æ—¶è¾ƒé•¿çš„æ¨¡å—åŒ…æ‹¬ï¼š

* TiDB
  * parser (yyParse)
  * table (CastValue)
  * talbes (*TableCommon.AddRecord)
  * ddl (*addIndexWorker.backfillIndexInTxn)
  * tikv (.tikvSnapshot.Get)
  * session (*session.ExecutePrepareStmt)
  * planner (Optimize)
  * executor (*ExecStmt.handlePessimisticDML)
  * checksum (*Reader.ReadAt)
* runtime
  * mallocgc
  * scanobject
* syscall (io)

